window.bd=window.bd||{};(function(f){var e=this,b={};var a={driver:"LocalStorage"};b.inherit=function(k,i,h){var g;function j(){}j.prototype=i.prototype;k.prototype=new j();k.prototype.constructor=k;for(g in h){if(Object.prototype.hasOwnProperty.call(h,g)){k.prototype[g]=h[g]}}k.prototype.__parent=function(m,l){return i.prototype[m].apply(this,b.toArray(l)||[])};k.prototype.__construct=function(l){i.apply(this,l||[])};return k};b.toArray=function(g){return b.isArray(g)?g:[g]};b.isArray=function(g){return g.isArray||g instanceof Array&&Object.prototype.toString.call(g)==="[object Array]"};var c=function(g){this._settings=f.extend(a,g);var h=c.setDriver(this._settings.driver);if(!h){return false}return new h(this._settings.options||{})};c.drivers={};c.stack=[];c.currentDriver=null;c.setDriver=function(g){var h;if(!!g!==true&&c.currentDriver){return c.currentDriver}h=c.drivers[g];if(h.test()){c.currentDriver=h;return h}return null};c.registerDriver=function(g,j){var i,h;h=function(){this.__construct(arguments);this.init&&this.init(arguments)};j=j||{};if(!j.test||typeof j.test!=="function"){throw"Driver "+g+" must always have a test method"}i=b.inherit(h,d,j);i._name=g;i.test=j.test;c.stack.push(i._name);c.drivers[g]=i;return i};var d=function(g){this.options=f.extend(this.defaultOptions,g)};d.prototype={constructor:d,defaultOptions:{namespace:""},name:"Driver",prefix:"",init:function(){},set:function(g,h){return this},get:function(g){return this},unset:function(g){return this},empty:function(){return this},_generateError:function(g,j,i){var h=new Error(g||"DEFAULT",j||"Default Error Massage",i);if(e.devMode){console.error(h.stack||h.message)}return h}};c.utils=b;c.Driver=d;if(typeof define==="function"&&define.amd){define(function(){return c})}e.Storage=c;return c}).apply(bd,[jQuery]);(function(){var c;var a=this;var b=jQuery;c=this.registerDriver("LocalStorage",{init:function(){var d;this.prefix=this.options.namespace?this.options.namespace+".":"";this.size=0;if(!c.stores[this.prefix]){c.stores[this.prefix]={}}this.table=c.stores[this.prefix];d=typeof Object.keys!=="undefined"?Object.keys(localStorage):b.map(localStorage,function(f,e){return e});b.each(d,function(f,e){if(e.indexOf(this.prefix)!==-1){this.table[e.substr(this.prefix.length)]=JSON.parse(localStorage[e]);this.size+=e.length;this.size+=localStorage[e].length}}.bind(this))},set:function(e,h){var i,g=[],j,d;if(typeof e=="string"||typeof e=="number"){i={};i[e]=h}else{i=e}try{for(j in i){if(typeof i[j]!=="undefined"){d=JSON.stringify(i[j]);localStorage.setItem(this.prefix+j,d);this.size+=d.length;this.size+=(this.prefix+j).length;this.table[j]=i[j];g.push(j)}}}catch(f){this._generateError(f)}return this.__parent("set",arguments)},get:function(e){this.__parent("get",arguments);var d={};if(a.utils.isArray(e)){b.each(e,function(f,g){d[g]=this.table[g]}.bind(this))}else{d=this.table[e]}return d},unset:function(d){var f;if(!d){return}f=a.utils.isArray(d)?d:[d];try{b.each(f,function(h,k){var g=this.prefix+k,j=localStorage.getItem(g);if(!j&&this.table[k]){j=JSON.stringify(this.table[k])}delete this.table[k];if(!j){return}this.size-=j.length;this.size-=j.length;localStorage.removeItem(g)}.bind(this));return this.__parent("unset",arguments)}catch(e){this._generateError(e)}},empty:function(){var d;for(d in this.table){localStorage.removeItem(this.prefix+d)}this.size=0;this.table=c.stores[this.options.namespace]={};return this.__parent("empty",arguments)},test:function(){return !!localStorage},_generateError:function(d){var e;if(d.message&&/(QUOTA)[\w\W]+(EXCEEDED)/i.test(d.message)){e="Local Storage Quota Exceeded Error. ";e+="Storage string length: "+this.size;return this.__parent("generateError",["QUOTA",e,d])}else{return this.__parent("generateError",arguments)}}});c.stores={}}).apply(bd.Storage);