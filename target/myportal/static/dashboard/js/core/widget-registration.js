bd.registerGagdgets=function(r){var g=b$.require("portal.widget.StylesheetResource");var j=b$.require("portal.widget.ScriptResource");var q=b$.require("portal.widget.Resources");var k=b$.require("portal.mappings.xml.CustomWidgetHandler");var o=b$.require("portal.WidgetTypePackage");var l=b$.require("packages.portal4gadgets.Portal4GadgetsTypePackage");var h=b$.require("packages.portal4gadgets.Portal4GadgetsWidgetHandler");var f=b$.require("packages.portal4gadgets.widget.Widget");var m=b$.require("packages.portal4gadgets.views.widget.Widget");var b=m.extend(function(x,v,w){m.call(this,x,v,w);this.model.view=this});var d=h.extend(function(){k.call(this,"backbase");this.factories={};this.builders={}});d.prototype.createModelBuilder=function(v,A,z,x,w){var y=z.getByName("src");y.setValue(y.getValue().replace("$(contextRoot)",bd.contextRoot));return h.prototype.createModelBuilder.call(this,v,A,z,x,w)};var p=l.extend(function(){o.call(this,new d(),[f,b])});var u=k.extend(function(){k.call(this,"dashboard")});var s=k.extend(function(){k.call(this,"w3c")});u.prototype.createModelBuilder=function(v,z,y,x,w){return{build:function(A){var B=y.getByName("stylesheetResources");var F=y.getByName("javascriptResources");var D=[];var J=new bd.ResourceTracker();if(B){var C=B.getValue();if(bd.oPortalClient!=null&&bd.oPortalClient.params!=null){C=be.utils.replaceParams(C,bd.oPortalClient.params)}var E=C.split(",");for(var G=0;G<E.length;G++){if(bd.invalidateEverything==true){E[G]=E[G]+"?invalidate="+new Date().getTime()}D.push(new g("external","text/css",E[G]))}}if(F){var C=F.getValue();if(bd.oPortalClient!=null&&bd.oPortalClient.params!=null){C=be.utils.replaceParams(C,bd.oPortalClient.params)}var H=C.split(",");J.numberOfResources+=H.length;for(var G=0;G<H.length;G++){if(bd.invalidateEverything==true){H[G]=H[G]+"?invalidate="+new Date().getTime()}D.push(new j("external","text/javascript",H[G]))}}var I=new q(D);I.tracker=J;var K=bd.getWidgetInstance("dashboard",w,z,v,y,true,I);A.acceptBuildResult(K)}}};s.prototype.createModelBuilder=function(v,A,y,x,w,z){return{build:function(C){var B=bd.getWidgetInstance("w3c",w,A,v,y,true,null,z);C.acceptBuildResult(B)}}};if(r.params.portalType=="dashboard"){var a=b$.require("bd.widgets.DashboardWidget");var n=b$.require("bd.widgets.DashboardWidgetView");var t=[a,n];r.registerWidgetTypePackage(new o(new u(),t))}else{var c=b$.require("bd.widgets.W3CWidget");var e=b$.require("bd.widgets.W3CWidgetView");var i=[c,e];r.registerWidgetTypePackage(new o(new s(),i))}r.registerWidgetTypePackage(new p())};bd.getWidgetInstance=function(i,j,c,e,a,d,b){var k;switch(i){case"backbase":if(bd.portalName!="dashboard"){var h=b$.require("packages.portal4gadgets.widget.Widget");k=new h(j,c,e,a,d,b)}break;case"w3c":var g=b$.require("bd.widgets.W3CWidget");k=new g(j,c,e,a,d,b);break;case"dashboard":var f=b$.require("bd.widgets.DashboardWidget");k=new f(j,c,e,a,d,b)}k.parentItemName=c;return k};