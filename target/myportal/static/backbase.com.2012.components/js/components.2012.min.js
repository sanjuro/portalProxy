if(!window.bc){window.bc={}}if(!window.bd){window.bd={}}bc.component=(function(z){var H="/static/backbase.com.2012.components/html/";var E="bc-component-disabled";var G="bc-component-hidden";var f=null;bd.contextRoot=bd.contextRoot||top.bd.contextRoot;H=bd.contextRoot+H;var R=function(T,V){var U=be.utils.processHTMLTemplateByUrl(T,V);var S=jQuery(U);return S};var C=function(S,T){if(T.target){jQuery(T.target).append(S)}return S};var A=function(T){var S=R(H+"panel/spinner.html",T);return C(S,T)};var t=function(T){var S=R(H+"panel/feedback.html",T);return C(S,T)};var h=function(T){var S=R(H+"panel/pagination.html",T);return C(S,T)};var q=(function(){var T={};var W=[];var Z=function(aa){var ab="id_"+aa.uid;if(!T[ab]){aa.index=W.length;T[ab]=aa;W.push(ab)}return aa};var U=function(){var ab;for(var aa=0;aa<W.length;aa++){ab=T[W[aa]];if(ab){ab.index=aa;ab.reposition()}}};var S=function(aa){var ab="id_"+aa.uid;if(T[ab]){W.splice(aa.index,1);delete T["id_"+aa.uid]}aa=null;U()};var V=function(aa){return !!T["id_"+aa.uid]};var Y=function(aa){return T["id_"+aa]};var X=function(){return W.length};return{add:Z,remove:S,has:V,item:Y,length:X}})();var d=function(T){this.timeout=null;this.index=null;this.uid=T.uid;this.message=T.message;this.delay=T.delay||this.message.length*70;this.$template=this.createView({icon:T.icon||"checkbox",uid:this.uid,message:T.message,className:T.className,data:T.data,y:(10+(q.length()*85))+"px"});var S=this;this.$template.on("click",function(){S.hide(true)});this.show()};d.prototype.show=function(){this.$template.animate({opacity:1,"margin-top":"+=10"});if(this.delay>-1){this.hide()}};d.prototype.hide=function(T){var S=this,U=T?0:this.delay>-1?this.delay:1;clearTimeout(this.timeout);this.timeout=setTimeout(function(){S.$template.animate({opacity:0,"margin-top":"+=10"},function(){S.$template.off().remove();q.remove(S)})},U)};d.prototype.createView=function(V){var S=R(H+"modal/notify.html",V);S.css({visibility:"hidden",opacity:0});jQuery(document.body).append(S);var T=S.outerWidth();S.css({visibility:"visible","margin-left":-T/2+"px",top:V.y});if(V.className){S.addClass(V.className)}if(V.data){for(var U in V.data){S.data(U,V.data[U])}}return S};d.prototype.reposition=function(){var S=10+(this.index*85);this.$template.animate({top:S+"px"})};var j=function(T){var S;if(T.icon&&T.icon!=="error"){if(q.has(T)){S=q.item(T.uid);if(S.delay>-1){S.hide()}}else{S=new d(T);if(!(S.type&&S.type==MSG_TYPE_PROGRESS)){q.add(S)}}return S}else{T.status="error";T.closeIcon=false;T.title=(T.title||"ERROR").toUpperCase();T.html=T.message||T.text;T.text=T.message||T.text;T.buttons=[{title:"OK",type:"ok",callback:function(){}}];return N(T)}};var x=function(S){if(bc.dialogOpen){return}var U=R(H+"modal/form.html",S);U.css({visibility:"hidden",opacity:0});jQuery(document.body).append(U);bc.dialogOpen=true;var W=function(ae){var ab=jQuery(ae),ad=ab.length;for(var ac=0;ac<ab.length;ac++){$name=ab.get(ac).name,$value=ab.get(ac).value,$required=jQuery(ab.get(ac)).hasClass("required"),$valid=!$required||$required&&$value!=="";if($valid){ad--}jQuery(ab.get(ac)).removeClass("valid error").addClass($valid?"valid":"error")}return ad===0};if(S.width){U.css({width:S.width})}var V=S.okCallback||function(){};var Z=S.cancelCallback||function(){};var aa=jQuery("form",U);var T=U.outerWidth();var Y=U.outerHeight();U.css({visibility:"visible","margin-left":-T/2+"px","margin-top":(-Y/2)-10+"px"});$modalCover=jQuery('<div class="bc-modal-cover '+S.cls+'"></div>');jQuery("body").append($modalCover);$modalCover.css({opacity:0}).animate({opacity:0.3});U.animate({opacity:1,"margin-top":"+=10"});jQuery('input[type="text"]',U).first().focus();jQuery(".bc-modal-close, .bc-modal-cancel",U).bind("click",function(){Z(aa);$modalCover.animate({opacity:0},function(){$modalCover.remove()});U.animate({opacity:0,"margin-top":"+=10"},function(){U.remove();jQuery(document).off("keyup",X);bc.dialogOpen=false});return false});if(S.ok!==false){jQuery(".bc-modal-ok",U).bind("click",function(ab){ab.preventDefault();if(S.disableValidation||W(U.find("input"))){if(V(aa)!==false){$modalCover.animate({opacity:0},function(){$modalCover.remove()});U.animate({opacity:0,"margin-top":"+=10"},function(){U.remove();jQuery(document).off("keyup",X);bc.dialogOpen=false})}}else{bc.component.notify({uid:"4432",icon:"error",message:"Invalid input"})}return false})}else{jQuery(".bc-modal-ok",U).hide()}if(!S.disableValidation){U.on("keyup blur","input",function(ab){W(ab.target)})}var X=function(ab){if(ab.keyCode==27){jQuery(".bc-modal-close",U).trigger("click")}};jQuery(document).on("keyup",X);return U};var I=function(S){};var a=function(T){var S=R(H+"form/textarea.html",T);return C(S,T)};var c=function(T){var S=R(H+"form/textbox.html",T);return C(S,T)};var L=function(T){var S=R(H+"panel/balloon.html",T);return C(S,T)};var g=function(T){var S=R(H+"panel/tabs.html",T);jQuery(".bc-tabLabel",S).click(function(){jQuery(".bc-tabLabel, .bc-tab",S).removeClass("bc-activeTab");jQuery(this).addClass("bc-activeTab")});jQuery(".bc-tabLabel:first-child",S).addClass("bc-activeTab");return C(S,T)};var K=function(V){var U=be.utils.processHTMLTemplateByUrl(H+"form/checkboxes.html",V);var S=jQuery(U);var T=jQuery("input",S);S.click(function(W){W.stopPropagation();if(S.hasClass("c_off")){T.attr("checked","checked")}else{T.removeAttr("checked")}S.toggleClass("c_on c_off")});if(V.target){z(V.target).append(S)}return S[0]};var M=function(V){var U=be.utils.processHTMLTemplateByUrl(H+"form/radio.html",V);var T=jQuery(U);var S=jQuery("input",T);T.click(function(W){W.stopPropagation();jQuery('input[type="radio"][name="'+V.name+'"]',document).removeAttr("checked").trigger("change");S.attr("checked","checked").trigger("change")});S.change(function(W){T.toggleClass("c_on",S.attr("checked")==="checked");if(S.attr("checked")==="checked"&&V.handler){V.handler()}});if(V.target){z(V.target).append(T)}return T[0]};var B=function(U){var X=R(H+"form/tooltip.html",U),W=jQuery(".bc-tooltip",X).remove(),ab,ac,V,aa,Z,T=U.message;var Y=function(){W.toggleClass("bc-tooltip-flip-h",aa>ac);W.toggleClass("bc-tooltip-flip-v",Z<V)};var S=function(ae){var ad={top:0,left:0};while(ae&&ae.offsetParent){ad.top+=ae.offsetParent.scrollTop||0;ad.left+=ae.offsetParent.scrollLeft||0;ae=ae.offsetParent}return ad};X.mouseover(function(ae){var ad=jQuery(ae.currentTarget);ab=jQuery(this).parent().attr("title")||T;jQuery(this).attr("title","");jQuery(".bc-tooltip-body",W).text(ab);jQuery(this).append(W);ac=W.outerWidth();V=W.outerHeight();W.css("opacity","0");W.fadeTo("1",0.9);aa=z(ae.target).offset().left-S(ae.target).left;Z=z(ae.target).offset().top-S(ae.target).top;Y()}).mousemove(function(ad){}).mouseout(function(){jQuery(this).attr("title",jQuery(".bc-tooltip-body").html());jQuery(".bc-tooltip",this).remove()});return C(X,U)};var F,n,i;var D=function(ag){var aa={align:"right",overTip:false};var V=top?top.jQuery:jQuery,ad=i||V(".bc-hovertip-tip"),U,ak=V.extend({},aa,ag.data),af=0,T=V(this),X=this,S=ak.events,ae=ak.align||"right",Y=Mustache.to_html("{{title}}",{title:T.attr("title")}),W=T.offset(),ac=function(){clearTimeout(F);V(".bc-hovertip-tip").off().remove();i=null;if(Y){T.attr("title",Y)}T.off("mousemove",Z)},ah=function(){if(Y){T.attr("title",Y)}clearTimeout(F);clearTimeout(n);F=setTimeout(ac,100)},Z=function(al){var am=ad.offset();am.left=al.clientX-(!ak.align?0:ak.align==="center"?ad[0].offsetWidth/2:ak.align==="right"?ad[0].offsetWidth-20:ak.align==="left"?-20:0);ad.offset(am)},ab=function(){clearTimeout(F);V(this).on("mouseleave",ah)},ai=function(){var al=ad[0].offsetWidth;W.top-=ad.height()+30;W.left=ag.clientX-ad.width();switch(ae){case"right":break;case"left":case"center":W.left+=al/2;ad.addClass("bc-hovertip-tip-center");case"middle":W.left+=T.width()/2}if(ak.offset){W.left+=ak.offset.left;W.top+=ak.offset.top}if(W.top<10){W.top=T.offset().top+T.height()+12;ad.addClass("bc-hovertip-h-flip")}if(W.left<ad.width()){W.left=10;ad.addClass("bc-hovertip-tip-flip")}ad.offset(W);ad.css("opacity",0);if(T.data("tooltip-width")){ad.width(T.data("tooltip-width"))}},aj=function(){if(!ad.length||ad.length&&ad[0].ref!=X){if(ad.length){ac()}T.attr("title","");ad=R(H+"form/moTooltip.html",ak);if(ak.content){ad.html(ak.content)}else{if(Y){ad.text(Y)}}if(ak.cssClass){ad.addClass(ak.cssClass)}ad.appendTo(V("body"));ad[0].ref=X;i=ad;if(ak.onTooltipShow&&V.isFunction(ak.onTooltipShow)){ak.onTooltipShow(ad)}U=ad.css("opacity");ai();ad.fadeTo(".9",U);if(ak.overTip){ad.on("mouseover",ab)}T.on("mousemove",Z)}};clearTimeout(F);if(ak.startDelay){clearTimeout(n);n=setTimeout(aj,ak.startDelay)}else{aj()}T.on("mouseleave click",ah);jQuery(document).on("keydown",function(al){if(al.keyCode===27){ah()}})};var w=function(S,V){var T=top?top.jQuery:jQuery,U=V.context?T(S,V.context):T(S);U.off("mouseenter",this.moTooltip).on("mouseenter",V,this.moTooltip);T(document).off("keyup.tooltip").on("keyup.tooltip",function(W){if(W.keyCode===27){T(".bc-hovertip-tip").off().remove()}})};var l=function(T){var S=R(H+"form/formsteps.html",T);jQuery(".bc-formstep:first-child",S).addClass("bc-formstep-active");jQuery(".bc-formstep",S).click(function(){var U=jQuery(this).parent().children(".bc-formstep").index(this);jQuery(".bc-formstep").removeClass("bc-formstep-active");jQuery(this).addClass("bc-formstep-active");T.steps[U].callback()});return C(S,T)};var r=function(W){W.activeClassName="toggle-checked";var U=R(H+"form/toggle.html",W),Y=jQuery("input",U),S=jQuery("label",U);var V=function(Z){if(!Z){S.addClass(W.activeClassName)}else{S.removeClass(W.activeClassName)}};var X;Y.on("click",function(Z){if(jQuery(this).data("disabled")){Z.preventDefault();Z.stopPropagation();return false}U[0].val=this.checked;S.toggleClass(W.activeClassName,this.checked);Y.attr("checked",this.checked)});jQuery(U).on("click keydown",function(Z){clearTimeout(X);if(Y.data("disabled")||(Z.type=="keydown"&&!(Z.which==13||Z.which==32||Z.which==37||Z.which==38||Z.which==39||Z.which==40))){Z.preventDefault();Z.stopPropagation();return false}var ab=this;var aa=Y.attr("checked");if(!aa){Y.attr("checked","checked")}else{Y.removeAttr("checked")}V(aa);if(W.callback){X=setTimeout(function(){W.callback(jQuery(ab),Y)},300)}});var T=C(U,W);if(!W.wrapped){return T}else{return new y(T,W)}};var P=function(an){var ap,ao,aa,aq=null,ak,ac,af,ai=0,V=0;if(an.type){ap=H+"dropdown/"+an.type+".html"}else{ap=H+"dropdown/dropdown.html"}if(an.type=="image-select"){an.imageSelect=true}else{if(an.type=="action-icon"||an.type=="action-icon-div"){an.actionIcon=true;an.dropdown=true}else{if(an.type=="multi-select"){an.multiSelect=true}else{if(an.type=="action-select"){an.actionSelect=true;an.dropdown=true;an.header=an.header?an.header:"Add Menu Item"}else{if(an.type=="exec-select"){an.execSelect=true;an.dropdown=true}else{if(an.type=="all-select"){an.allSelect=true}else{if(an.type=="device-select"){an.deviceSelect=true}else{if(an.type=="preview-select"){an.previewSelect=true}else{if(an.type=="group-select"){an.groupSelect=true}else{if(an.type=="center-dropdown"){an.centerDropdown==true}else{an.dropdown=true}}}}}}}}}}for(ac in an.options){af=an.options[ac];af.stateClass=af.hide?G:af.disable?E:""}var ag=function(aA,aO){var aB=aO.offset();var aJ=aO.height();var aL=aO.width();var aw=jQuery(document).height();var az=jQuery(document).width();var au=jQuery(window).height();var aC=aA.outerWidth();var aE=aA.outerHeight();var aK=an.maxHeight?an.maxHeight:160;var aF=aJ+aE+(aB.top-z(window).scrollTop());var ax;var av=aB.left+aC;var ay=(aB.left-11)+"px";var aI=(aB.top+aJ)+"px";var aM="auto";var at=5;var aG=aA.find(".bc-scroll-section");var aN=aA.find("header");if(av>az){ay=(az-aC)-35+"px"}if(an.boundRight){ay="auto";aM=0}else{if(an.openLeft){ay=(aB.left+aL+3)+"px";aI=(aB.top-at)+"px"}else{if(an.centerDropdown){ay=(aB.left+24)+"px"}}}var aH=149;aA.css({position:"absolute",top:aI,left:ay,right:aM,bottom:"auto","z-index":"2000","max-height":aK+"px",overflow:"auto",width:"auto","min-width":function(){if(aH>aL){return aH+"px"}else{return(aL+32)+"px"}}});if(!an.slideup){if(aF>au){ax=true;aO.addClass("bc-slideup");aA.addClass("bc-shadow-up")}else{ax=false;aO.removeClass("bc-slideup");aA.removeClass("bc-shadow-up")}}if((an.slideup)||(ax)){var aD=aw-aB.top;if(aw>document.body.clientHeight){aD=aD-(aw-document.body.clientHeight)-at}else{aD=aD-at}if(an.openLeft){aD=aD-aJ}aA.css({top:"auto",bottom:aD+"px"})}if(an.actionSelect||an.execSelect){aA.css({"margin-left":"-40px"})}aO.addClass("bc-open");aA.slideDown("fast",function(){aA.css("overflow","auto");var aP=aA.height();if(aP){aG.css({"max-height":aP-aN.height()})}})};var am=function(au,at){if(au[0].beforeClose&&au[0].beforeClose(ae)===false){return}au.slideUp("fast",function(){au.detach();at.removeClass("bc-open")})};var S=function(aB){var ay=aB.value;var at=z(aB).closest(".bc-dropdown-items");var au=at.find(".bc-dropdown-item");for(var ax=0;ax<au.length;ax++){var aC=au[ax].getAttribute("data-search")||"";aC=aC.toLowerCase();var aA=aC.search(ay);if(aA!==-1&&ay!==""){if(au[ax].dataset.group){var av=at.find(".bc-dropdown-item-header");for(var aw=0;aw<av.length;aw++){if(av[aw].getAttribute("data-group")==au[ax].getAttribute("data-group")){z(av[aw]).removeClass("bc-dropdown-item-searchhide");z(av[aw]).addClass("bc-dropdown-item-searchshow")}}}z(au[ax]).removeClass("bc-dropdown-item-searchhide");z(au[ax]).addClass("bc-dropdown-item-searchshow")}else{if(ay===""){z(au[ax]).removeClass("bc-dropdown-item-searchhide");z(au[ax]).removeClass("bc-dropdown-item-searchshow")}else{z(au[ax]).addClass("bc-dropdown-item-searchhide");z(au[ax]).removeClass("bc-dropdown-item-searchshow")}}}var az=z(aB).closest(".bc-dropdown-search");if(ay!==""){az.removeClass("bc-dropdown-search-empty")}else{if(!az.hasClass("bc-dropdown-search-empty")){az.addClass("bc-dropdown-search-empty")}}};if(!bc.dropdownInitDone){jQuery(document.body).bind("click",function(at){if(jQuery(".bc-dropdown-items").length>0){if(!z(at.target).hasClass("bc-dropdown-search-input")){am(jQuery(".bc-dropdown-items"),jQuery(".bc-selectbox.bc-open"))}}});jQuery(".bd-closeIcon").bind("click.component",function(at){if(jQuery(".bc-dropdown-items").length>0){am(jQuery(".bc-dropdown-items"),jQuery(".bc-selectbox.bc-open"))}});jQuery(document.body).on("click",".bc-selectbox",function(at){at.stopPropagation()});jQuery(document.body).on("click",".bc-dropdown-search-reset",function(at){at.stopPropagation();var av=z(at.target).closest(".bc-dropdown-search");var au=av.find(".bc-dropdown-search-input")[0];au.value="";S(au)});jQuery(document.body).on("keyup",".bc-dropdown-search-input",function(at){S(at.currentTarget)});jQuery(window).unbind("resize.dropDown").bind("resize.dropDown",function(at){if(jQuery(".bc-dropdown-items").length>0){am(jQuery(".bc-dropdown-items"),jQuery(".bc-selectbox.bc-open"))}});bc.dropdownInitDone=true}ap=be.utils.processHTMLTemplateByUrl(ap,an);var ah=be.utils.processHTMLTemplateByUrl(H+"dropdown/dropdown-options.html",an);var Y=jQuery(ah);if(an.cssClass){Y.addClass(an.cssClass)}var W=jQuery(ap);try{W.data("index",0)}catch(X){if(bd.devMode){console.log(X)}}if(!an.staticLabel){var aj=z(R(H+"dropdown/browser-selectbox.html",an));if(an.selected!==null||an.selected!==undefined){aj.val(an.selected);Y.find("a").filter(function(){return z(this).data("value")==an.selected}).addClass("bc-template-selected")}if(!an.target){W.wrap('<div class="bc-selectbox-wrapper" />');W.prepend(aj)}else{var U=jQuery(an.target),ab="bc-dd-"+(an.type?an.type+"-"+an.uid:an.uid),T=z("."+an.forlabel+"[data-cid='"+ab+"']",U);T.remove();U.prepend(aj)}}var al=W.find("span.bc-custom-checkbox");if(al.length){al.each(function(){var at=bc.component.checkBox({color:"grey"});jQuery(this).replaceWith(at)})}var Z=function(ax){var av=ax.closest(".bc-scroll-section");var au=av.find(".bc-dropdown-item");var at=ax.attr("data-group");for(var aw=0;aw<au.length;aw++){if(!z(au[aw]).hasClass("bc-dropdown-item-header")&&(au[aw].getAttribute("data-group")==at)){if(ax.hasClass("bc-dropdown-item-header-open")){z(au[aw]).addClass("bc-dropdown-item-grouphide")}else{z(au[aw]).removeClass("bc-dropdown-item-grouphide")}}}ax.toggleClass("bc-dropdown-item-header-open")};var ad=function(ax,ay){var av=Y.find("span.bc-custom-checkbox");if(av.length){av.each(function(aB){var aC=bc.component.checkBox({color:"grey",checked:!!an.options[aB].checked});jQuery(this).replaceWith(aC)})}ak=Y.find("a");if(an&&an.options){for(var au=0,at=an.options.length;au<at;au++){if(an.options[au]){var aw=an.options[au],az=ak.eq(au);if(an.actionSelect||an.execSelect||an.actionIcon||an.customHandlers){ak[au].handler=aw.handler}az.data("index",au);if(an.label&&az.text()==an.label){ai=V=parseInt(az.data("index"),10);if(an.groupSelect){var aA=Y.find(".bc-dropdown-item-header[data-group="+az.attr("data-group")+"]");Z(aA)}az.addClass("bc-template-selected")}}}}ak.on("click.ddoptions",function(aC){var aD=jQuery(this);if(aD.data("disabled")){aC.preventDefault();aC.stopPropagation();return false}if((!an.staticLabel)&&(!an.noSelect)&&!z(aC.currentTarget).hasClass("bc-dropdown-item-header")){var aB=jQuery(".bc-option-label",aD).text();jQuery(".bc-label",ax).text(aB);ay.attr("value",aD.attr("data-value"));ay.val(aD.attr("data-value"));if(!an.execSelect){aD.siblings().removeClass("bc-template-selected");aD.addClass("bc-template-selected")}}if(an.multiSelect){aC.stopPropagation();aD.children(".bc-custom-checkbox").trigger("click")}else{if(an.allSelect){if(aD.hasClass("bc-selectall")){ax.find(".bc-custom-checkbox").removeClass("c_off").addClass("c_on").children("input").attr("checked",true)}else{ax.find(".bc-custom-checkbox").removeClass("c_on").addClass("c_off").children("input").attr("checked",false)}}else{if(an.groupSelect){if(aD.hasClass("bc-dropdown-item-header")){aC.stopPropagation();Z(aD)}if(this.handler){this.handler(aC)}}else{if(an.execSelect||an.customHandlers){if(this.handler){this.handler(aC)}}else{am(Y,ax)}}}}ai=parseInt(aD.data("index"),10);if(ay){ay.trigger("change")}})};ad(W,aj);var ar=function(at){var av=jQuery(this);if(at.type=="keydown"){if(!(at.which==13||at.which==32||at.which==38||at.which==40)){return}at.preventDefault();at.stopPropagation()}if(an.stopPropagation){at.stopPropagation()}if(av.hasClass("bd-gradient-grey-disabled")||av.hasClass("bd-groups-empty")){at.stopImmediatePropagation()}else{if(at.which==38||at.which==40){if(ak.length==0){ak=Y.find("a")}ai=at.which==38?ai-1:ai+1;ai=ai>ak.length-1?0:ai<0?ak.length-1:ai;var au=ak.eq(ai);if(au.length){ak.removeClass("bc-hovered");au.addClass("bc-hovered")}return}if(jQuery(".bc-dropdown-items").length>0){am(jQuery(".bc-dropdown-items"),jQuery(".bc-selectbox.bc-open"))}if(av.hasClass("bc-open")){ak=Y.find("a");if(at.type=="keydown"&&(ai!=V||ak.length==1)){ak.eq(ai).trigger("click")}else{am(Y,av)}}else{jQuery(document.body).append(Y);if(an.allSelect&&at.target==av.children(".bc-custom-checkbox")[0]){return}else{if(an.actionSelect&&av[0].nodeName.toLowerCase()=="button"){return}else{if(an.execSelect&&av[0].nodeName.toLowerCase()=="button"){if(an.handler){an.handler(at)}else{return}}else{if(Y[0].beforeOpen&&Y[0].beforeOpen(ae)===false){return}ag(Y,av);return false}}}}}};W.on("click keydown",ar);W[0].dropdownOptions=Y;Y[0].getOptsParent=function(){return W};if(an.beforeOpen){Y[0].beforeOpen=an.beforeOpen}if(an.beforeClose){Y[0].beforeClose=an.beforeClose}var ae=C(W,an);if(an.wrapped){ae=new y(ae,an,Y)}return ae};var e=function(Y){var X={},S=jQuery.extend({},X,Y),U=R(H+"form/slider.html",S),V=U.find(".bc-slider-value"),W=U.find(".bc-slider-container"),T=U.find(".bc-slider-input");V.text(Y.range?Y.values.join(" - "):Y.value);S.slide=function(Z,aa){V.text(Y.range?aa.values.join(" - "):aa.value);aa.handle.title=aa.value;console.log(T,aa.value);T[0].value=aa.value;if(Y&&jQuery.isFunction(Y.slide)){Y.slide(Z,aa)}};W.slider(S);return C(U,Y)};var y=function(ab,T,ah){var Z=ah?ah:ab;var S=function(aj){var ai=aj===parseInt(aj,10);if(ai){}else{return jQuery(aj,Z)}};var ag=function(ai){};var V=function(ai){};var X=function(ai){S(ai).removeClass(E).data("disabled",false)};var U=function(ai){S(ai).addClass(E).data("disabled",true)};var af=function(ai){S(ai).removeClass(G).data("hidden",false)};var Y=function(ai){S(ai).addClass(G).data("hidden",true)};var W=function(aj,ai){S(aj).toggleClass(G,!ai).data("hidden",!ai)};var ad=function(aj,ai){S(aj).toggleClass(E,!ai).data("disabled",!ai)};var ac=function(ai){};var aa=function(ai){};var ae;return{view:ab,show:af,hide:Y,toggle:W,enable:X,disable:U,toggleEnabled:ad}};var m=function(T){if(T.type){switch(T.type){case"primary":T.primary=true;T.color="green";break;case"secondary":T.secondary=true;break;case"button-text":T.textbutton=true;break;case"loadmore":T.loadmore=true;break;case"additem":T.additem=true;break;case"bigbutton":T.bigbutton=true;T.noshadow=true;break;case"dashboardclose":T.dashboardclose=true;T.shadow=true;break;case"sort":T.sortButton=true;break}}else{T.primary=true}if(!T.color){T.color="grey"}var S=R(H+"button/button.html",T);return C(S,T)};var J=function(U){var T=-1;var S=R(H+"button/toggleButton.html",U);S.click(function(W){var X=jQuery(this),V=jQuery(W.target);if(V[0].tagName.toLowerCase()==="span"){V=V.parent("div")}if(V.hasClass("bc-view-active")&&!U.allowInactive||V.hasClass("bd-gradient-grey-disabled")){return}V.toggleClass("bc-view-active");if(!U.multiSelect){V.siblings().removeClass("bc-view-active")}X.find("> div").each(function(Y,aa){var Z=jQuery(aa);if(U.buttons[Y].iconCls){if(Z.hasClass("bc-view-active")){jQuery("> span",Z).removeClass(U.buttons[Y].iconCls);jQuery("> span",Z).addClass(U.buttons[Y].activeIconCls)}else{jQuery("> span",Z).removeClass(U.buttons[Y].activeIconCls);jQuery("> span",Z).addClass(U.buttons[Y].iconCls)}}if(aa===V[0]&&U.buttons[Y].handler){U.buttons[Y].handler(V.hasClass("bc-view-active"))}})});return C(S,U)};var v=function(S,T){S.animate({opacity:"0",filter:"alpha(opacity=0)","margin-top":"+=10"},function(){console.log("animation 1 done");S.remove()});T.animate({opacity:"0",filter:"alpha(opacity=0)"},function(){console.log("animation 2 done");T.remove();f=null})};var k=function(S){this.hide=function(){var T=new z.Deferred();jQuery(document).off("keyup.dialog");var W=this;var V=this.$template.animate({opacity:"0",filter:"alpha(opacity=0)","margin-top":"+=10"});var U=this.$modalCover.animate({opacity:"0",filter:"alpha(opacity=0)"});z.when(V,U).then(function(){W.$template.remove();W.$modalCover.remove();f=null;bc.dialogOpen=false;T.resolve()});return T.promise()};this.show=function(){bc.dialogOpen=true;jQuery(".bc-modal-notify").hide();jQuery(document.body).append(this.$template);var U=this.$template.outerWidth();var T=this.$template.outerHeight();jQuery("body").append(this.$modalCover);this.$modalCover.css({opacity:0}).animate({opacity:0.3});this.$template.css({visibility:"visible","margin-left":-U/2+"px","margin-top":(-T/2)-10+"px"});this.$template.animate({opacity:1,"margin-top":"+=10"})};this.is=function(T){return T&&this.params.message==T.params.message};this.$template=null;this.$modalCover=null;this.params=S;return this};var N=function(Z){var Y=new k(Z);if(Y.is(f)){return}else{if(f){f.hide().done(function(){N(Z)});return}}f=Y;var X={title:"Sorry",message:"An unknown error has occurred",closeIcon:true,respondToEscKey:true,buttons:[{title:"OK",type:"white",callback:function(){}},{title:"Cancel",type:"text",callback:function(){}}]};Z=jQuery.extend(X,Z||{});var U=R(H+"modal/dialog.html",Z);var T=jQuery('<div class="bc-modal-cover"></div>');f.$template=U;f.$modalCover=T;U.css({visibility:"hidden",opacity:"0",filter:"alpha(opacity=0)"});for(var V=0,S=Z.buttons.length;V<S;V++){var W=R(H+"button/modal.html",Z.buttons[V]);if(Z.buttons[V].style){W.css(Z.buttons[V].style)}U.find(".bc-button-row").append(W);if(!Z.buttons[V].textOnly&&!Z.buttons[V].disabled){W.bind("click",(function(aa){return function(ab){ab.preventDefault();if(Z.buttons[aa].callback){Z.buttons[aa].callback()}f.hide()}})(V))}}if(Z.closeIcon){U.find(".bc-modal-close").bind("click",function(aa){aa.preventDefault();f.hide()})}if(Z.respondToEscKey){jQuery(document).on("keyup.dialog",function(aa){if(aa.keyCode===27){f.hide()}else{if(aa.keyCode===13&&Z.buttons.length==1){W.trigger("click")}}return false})}f.show()};var p=function(T){var S=R(H+"panel/hint.html",T);return C(S,T)};var O=function(U){var S=S||b$.require("bd.date.DateLib");var T=this;this.dateLib=this.getDateLib();this.today=this.dateLib.currentDay();this.startDate=U.val=U.val?this.dateLib.formatDate(U.val):"";this.serverFormattedDefaultDate=this.dateLib.formatDateForServer(this.startDate);this.$template=this.getTemplate(U);this.$btn_incr=z(".bc-date-incr",this.$template);this.$btn_decr=z(".bc-date-decr",this.$template);this.$dateField=z(".bc-date-input",this.$template);this.callback=U.callback;this.$template.on("click",function(X){var V=z(X.target).closest(".bd-button"),W=V.hasClass("bc-date-decr")?-1:V.hasClass("bc-date-incr")?1:0;if(W!==0){T.adjustDate(W)}});this.$template.on("keyup",function(V){T.dateChanged()});this.$template.on("keydown",function(V){T.previousValue=T.$dateField.val()});if(U.target){z(U.target).append(this.$template)}};O.prototype={reset:function(){this.$dateField.val(this.startDate)},getTemplate:function(S){return R(H+"form/date.html",S)},getDateLib:function(){var T=T||b$.require("bd.date.DateLib");var S=T.DATE_FORMAT_US,U="/";if(bc.dateTimeFormat.dateShort){U=bc.dateTimeFormat.dateShort.match(/([\/\.\-])/)[0];var W=bc.dateTimeFormat.dateShort.split(U);for(var V=0;V<3;V++){W[V]=W[V].replace(/^(d|M)$/,"\\d{1,2}").replace(/^(dd|MM)$/,"\\d{2}").replace(/^(y|yy)$/,"\\d{2,4}")}var X=new RegExp(W.join("\\"+U));S={example:bc.dateTimeFormat.dateShort,format:bc.dateTimeFormat.dateShort,test:function(Y){return X.test(Y)},convert:function(aa,Z,Y){Z=Z||"";return aa.split(T.delimiter).join(Z)}}}return this.dateLib||new T(S,"yyyymmdd",U)},adjustDate:function(U){var S=S||b$.require("bd.date.DateLib");var T=S.parseDate(this.$dateField.val());var V;if(T){if(U===1){T=T.next()}else{T=T.prev()}V=T.toString(bc.dateTimeFormat.dateShort)}else{V=this.today}this.$dateField.val(V);if(this.callback){this.callback(this.dateLib.formatDateForServer(V))}},dateChanged:function(){var S=S||b$.require("bd.date.DateLib");var T=this.$dateField.val(),U=S.parseDate(T),V;if(be.utils.trimString(T)===""){if(this.callback){this.callback("")}}else{if(U&&isFinite(new Date(U.toString("yy-MM-dd")))&&this.previousValue!==T){V=U.toString(bc.dateTimeFormat.dateShort);if(this.callback){this.callback(this.dateLib.formatDateForServer(V))}}}}};var u=function(T){var S=new O(T);return S};var s=function(U){U.activeClassName="toggle-checked";var T=R(H+"button/toggle.html",U);T.on("click",function(V){V.stopPropagation();if(V.target===jQuery(".bc-toggle-grip",T)[0]){var W=T.hasClass("checked")?false:true;if(U.handler){U.handler(W,function(){T.toggleClass("checked",W)})}else{T.toggleClass("checked",W)}}});var S=C(T,U);return S};var Q=function(U,T){var S=jQuery(".bc-s-selected",U).length;T.toggleClass("bc-s-active",S>0);T.toggleClass("bc-s-multi",S>1)};var o=function(S,T){setTimeout(function(){var Z='input:not(:hidden,.bc-toggle-switch,.bc-toggleSwitch,[type="checkbox"]), .bc-select, .bc-selectbox:not([class*="disabled"]), .toggle-switch, div.bc-switch, button, a:not(.bc-doc-link, .bd-pageNameLink), textarea, img',W=1,V=z(Z,S),U=0,Y,aa,X;if(bc.component.$fields){bc.component.$fields.each(function(){z(this).removeAttr("tabindex")})}bc.component.$fields=V;z('.bc-selectbox[class*="disabled"], select',S).attr("tabindex",-1);V.each(function(){var ab=z(this);ab.attr("tabIndex",W++)});if(T&&T.selectedIndex){U=T.selectedIndex>-1?T.selectedIndex:V.length-1}Y=V.eq(U);Y.focus();W=parseInt(Y.attr("tabindex"),10);z(window).off("keyup.bc-tab").on("keyup.bc-tab",function(ab){if(ab.which==9){X=parseInt(z(document.activeElement).attr("tabindex"),10);if(!X){Y.focus();W=1}else{if(X==W){X=W;V.eq(X).focus()}}W=X}})},400)};var b=function(X){var U=bd.selectedPortalName||(b$&&b$.portal&&b$.portal.portalName)||"dashboard";var W={minChars:2,offset:0,pageSize:20,url:bd.contextRoot+"/portals/"+U+"/pagemanagement/search/links",queryParam:"query",zindex:20000,contentType:"xml",tokenLimit:1,appendQuery:false,hintText:"Drag a page from the page list, or type a URL",resultsFormatter:function(Z){var aa=Z.finalUrl?' title="'+Z.finalUrl+'"':"",Y=Z.icon?('<i class="bd-cke-icn bc-icn '+Z.icon+'"></i>'):"";return"<li"+aa+">"+Y+Z.name+"</li>"},tokenFormatter:function(aa){var Z=aa.managed?"bd-man bc-tokenized":"bc-tokenized",ab=aa.finalUrl?' title="'+aa.finalUrl+'"':"",Y=aa.icon?'<i class="bc-icn '+aa.icon+'"></i>':"";return'<li class="'+Z+'" '+ab+">"+Y+aa.name+"</li>"},onResult:function(aa){var Z=aa.isJson?aa:bd.xmlToJson({xml:aa}).links||{link:[]},Y=Z&&Z.link||[],ab=[];Y=jQuery.isArray(Y)?Y:[Y];jQuery.each(Y,function(ac,ad){var ae=ad.properties.itemType.value;if(ad.parentItemName==U||ad.parentItemName=="masterpage_root"||ae=="menuHeader"||ae=="divider"){return}ab.push(T(ad))});if(X.appendQuery){ab.push({id:"0",name:z("tester").text()})}return ab}};X=z.extend({},W,X);var V=X.field,S=X.url;var T=function(Y){if(Y){var Z=top.bd&&top.bd.pm&&top.bd.pm.view.getItemTypeObj(Y);return{id:Y.uuid,name:Y.properties.title.value,icon:Z?Z.icon:"bc-page",finalUrl:Y.finalUrl,managed:true}}else{return{}}};z(V).closest(".bd-token-dnd").bdDrop({enter:function(aa,Z){var Y=Z.helper.bdDragData;if(Y.link){z(this).find(".token-input-list").addClass("bc-drag-over");z("#vakata-dragged").find("ins").hide()}return},leave:function(aa,Z){var Y=Z.helper.bdDragData;if(Y.link){z(this).find(".token-input-list").removeClass("bc-drag-over");z("#vakata-dragged").find("ins").show()}return},drop:function(aa,Z){var Y=Z.helper.bdDragData;if(Y.link){if(X.tokenLimit===1){V.tokenInput("clear")}z(this).find(".token-input-list").removeClass("bc-drag-over");V.addItem(Y.link)}return}});if(S.indexOf("?")<0){S=S+"?"}if(S.indexOf("ps=")<0){if(S.charAt(S.length-1)!="?"){S+="&"}S=S+"ps="+X.pageSize}if(S.indexOf("of=")<0){if(S.charAt(S.length-1)!="?"){S+="&"}S=S+"of="+X.offset}if(V.tokenInput){V.getTokenData=T;V.addItem=function(Y){V.tokenInput("add",T(Y))};z(".token-input-dropdown").remove();V.tokenInput(S,X);if(X.placeholder){z(".token-input-input-token input").attr("placeholder",X.placeholder)}}return V};return{balloon:L,button:m,checkBox:K,checkSelectedItems:Q,confirm:I,dialog:N,dropdown:P,dateField:u,feedback:t,formsteps:l,hint:p,modalform:x,moTooltip:D,notify:j,pagination:h,radioButton:M,setTooltip:w,slider:e,spinner:A,tabs:g,textArea:a,textBox:c,toggle:s,toggleButton:J,toggleSwitch:r,tooltip:B,tokenize:b,addKeyboardAccess:o}})(jQuery);jQuery(document).delegate(".bc-tab-label","click",function(b){var a=jQuery(b.target);a.addClass("bc-active-tab").siblings(".bc-tab-label").removeClass("bc-active-tab");if(a.data("for")!==undefined){jQuery(".bc-tab"+a.data("for")).show().siblings(".bc-tab").hide()}});jQuery(document).delegate(".bc-selectable-list .bc-s-item","click",function(c){var d=jQuery(this);var g=d.parent();var f=d.parents(".bc-s-wrapper");var e=jQuery(".bc-s-first",g);if(c.shiftKey&&e){g.children().removeClass("bc-s-selected");var a=g.children().index(e);var b=g.children().index(d);g.children().each(function(h,i){var j=jQuery(i);if(h>=Math.min(a,b)&&h<=Math.max(a,b)){if(j.is(":visible")){j.addClass("bc-s-selected")}}})}else{if((c.ctrlKey||c.metaKey)&&e){d.toggleClass("bc-s-selected")}else{d.addClass("bc-s-first").siblings().removeClass("bc-s-selected bc-s-first");d.toggleClass("bc-s-selected")}}bc.component.checkSelectedItems(g,f)});jQuery(document).on("click",function(a){if(jQuery(a.target).parents(".bc-selectable-list").length===0&&!bc.keepSelection){jQuery(".bc-s-selected").removeClass("bc-s-selected");jQuery(".bc-s-first").removeClass("bc-s-first");jQuery(".bc-s-wrapper").removeClass("bc-s-active bc-s-multi")}delete bc.keepSelection});(function(h,v,f){var H=function(I){this.nodes={tree:I.treeRoot,jumper:I.treeRoot.querySelector("."+I.jumperID)||I.jumperID||"bd-tree-jumper",toggle:I.treeRoot.querySelector("."+I.toggleID)||I.toggleID||"bd-tree-opener"};this.options={classPrefix:"bd-tree-",selectedClassName:"bd-tree-selected",collapsedClassName:"bd-tree-closed",openedClassName:"bd-tree-open",loadingClassName:"bd-tree-loading",jumperContainerClassName:"bd-tree-items",dataID:"data-uuid",toggleTime:400,easing:function(J){return -(--J*J*J*J-1)},dragOffset:12,click:"click",mouseover:"mouseover",mousedown:"mousedown",mousemove:"mousemove",mouseup:"mouseup"};this.tree=I.nodes;this.treeIndex={};this.callbacks={};B(this,I)},C={},w;H.prototype.buildTree=function(I){if(this.nodes.tree.getElementsByTagName("li").length){this.destroyTree(this.tree);this.tree=I}this.nodes.tree.innerHTML=o(I);s(this,this.nodes.tree)};H.prototype.destroyTree=function(){k(this,true);for(var I in this.tree){this.removeNode(this.tree[I][this.options.id],this.tree,I)}for(var J in this){this[J]=null;delete this[J]}};H.prototype.appendNode=function(L,R,Q,K){var O,I,J,S=false,M=this.treeIndex[R.nodeType?R.getAttribute(this.options.dataID):R]||R,N=M!==R,P=N?f:q(this,M,L);if(N){m(this,L,M,Q,K)}if(!P){return}J=P.htmlNode.parentNode.getElementsByTagName("ul")[0];S=J?!!J.children.length:false;O=document.createDocumentFragment();I=O.appendChild(document.createElement("ul"));I.innerHTML=o(N?[M]:M,L);s(this,I);if(J){while(I.children[0]){O.appendChild(I.children[0])}O.removeChild(I);J.appendChild(O);if(!S){I.style.height="";p(L.parentNode,this.options.collapsedClassName);n(L.parentNode,this.options.openedClassName)}}else{I.style.height="0px";n(L.parentNode,this.options.collapsedClassName);L.parentNode.appendChild(O)}i(L,this,!!Q,K===f?true:K)};H.prototype.insertBefore=function(K,R,P,J){var N=document.createDocumentFragment(),I=N.appendChild(document.createElement("div")),Q=this.treeIndex[K.nodeType?K.getAttribute(this.options.dataID):K],L=this.treeIndex[R.nodeType?R.getAttribute(this.options.dataID):R]||R,M=L!==R,O=M?f:q(this,R,K,Q.index);if(M){t(this,Q,L,P,J)}if(!O){return}I.innerHTML=o(R,K);s(this,I);while(I.children[0]){N.appendChild(I.children[0])}N.removeChild(I);K.parentNode.parentNode.insertBefore(N,K.parentNode)};H.prototype.removeNode=function(M,L,J){var I=M.nodeType?M.getAttribute(this.options.dataID):M,K;M=this.treeIndex[I];for(K in M.children){this.removeNode(M.children[K][this.options.id],M,K)}M.htmlNode.parentNode.parentNode.removeChild(M.htmlNode.parentNode);M.htmlNode=null;if(M["parent"+this.options.id]){if(J){L.children[J]=null;L.children.splice(J,1)}else{L=this.treeIndex[M["parent"+this.options.id]];for(K in L.children){if(L.children[K]===M){L.children[K]=null;L.children.splice(K,1);c(L,K);break}}}}this.treeIndex[I]=null;delete this.treeIndex[I]};H.prototype.selectNode=function(I){F(this.treeIndex[I.nodeType?I.getAttribute(this.options.dataID):I],this)};H.prototype.toggleNode=function(K,I,J){i(this.treeIndex[K.nodeType?K.getAttribute(this.options.dataID):K],this,I,J)};v.BBTree=H;v.BBTree.doAnimation=r;v.BBTree.addEvent=u;v.BBTree.removeEvent=A;v.BBTree.addClass=n;v.BBTree.removeClass=p;v.BBTree.hasClass=b;v.BBTree.getOrigin=G;function B(K,I){var L;for(var J in I){if(/Callback/.test(J)){K.callbacks[J]=I[J]}else{if(!/tree|nodes/.test(J)){K.options[J]=I[J]}}}K.options.id=K.options.dataID.split("-");K.options.id=K.options.id[1]||K.options.id[0];if(!K.nodes.jumper.nodeType){L=document.createElement("div");L.className=K.nodes.jumper;K.nodes.jumper=K.nodes.tree.appendChild(L);K.nodes.jumper.innerHTML='<div class="'+K.options.jumperContainerClassName+'"></div>';L=document.createElement("div");L.className=K.nodes.toggle;K.nodes.toggle=K.nodes.tree.appendChild(L)}w=K;if(K.tree&&K.tree){K.buildTree(K.tree)}k(K)}function l(I){for(var J in I){if(I.hasOwnProperty(J)){return false}}return true}function o(T,S){var U=[""],L,M=false,Q=false,P="",J=w.options.getTreeHTML?w.options.getTreeHTML(w,T,S):f,R=w.options.openedClassName,O=w.options.collapsedClassName,N=0;for(var I=0,K=T.length;I<K;I++){L=T[I];if(S){L["parent"+w.options.id]=S[w.options.id]||S.getAttribute(w.options.dataID)}L.index=N++;M=!!(L.children&&L.children.length);if(J===f){Q=!!L.children;P=M||Q?R:"";P=!M&&Q?O:P;if(L.type){P=P?" ":""+w.options.classPrefix+L.type}P=P?' class="'+P+'"':"";U.push("<li"+P+'><a href="#" data-'+w.options.id+'="'+L.uuid+'">'+L.title+"</a>");U.push(M||Q?"<ul>"+(L.children?o(L.children,L):"")+"</ul></li>":"</li>")}else{if(M){o(L.children)}}w.treeIndex[L.uuid]=L}return J||U.join("")}function D(K,M,J){var I;for(var L=M.children.length;L--;){if(M.children[L].tagName.toLowerCase()==="ul"){return M.children[L]}}if(J){I=document.createElement("ul");I.appendChild(J);M.appendChild(I);I.style.height="";n(I.parentNode,w.options.openedClassName);return I}}function x(K,I){for(var J=K.children.length;J--;){if(K.children[J]===I){K.children.splice(J,1);c(K,J);break}}}function m(O,M,K,J,N){var L=O.treeIndex[K["parent"+O.options.id]],I;M=q(O,[K],M);K["parent"+O.options.id]=M[O.options.id];x(L,K);I=D(O,M.htmlNode.parentNode,K.htmlNode.parentNode);p(M.htmlNode.parentNode,O.options.collapsedClassName);n(M.htmlNode.parentNode,O.options.openedClassName);M.htmlNode.parentNode.style.height="";I.appendChild(K.htmlNode.parentNode)}function t(N,L,J,I,M){var K=N.treeIndex[J["parent"+N.options.id]];q(N,[J],L[N.options.id],L.index);J["parent"+N.options.id]=L["parent"+N.options.id];if(J["parent"+N.options.id]===f){delete J["parent"+N.options.id]}x(K,J);L.htmlNode.parentNode.parentNode.insertBefore(J.htmlNode.parentNode,L.htmlNode.parentNode)}function q(O,K,L,J){var N=O.treeIndex[L.nodeType?L.getAttribute(O.options.dataID):L],M=J!==f;if(N){if(M){N=O.treeIndex[N["parent"+O.options.id]]}if(N.children){K.index=M?J:N.children.length;for(var P=0,I=K.length;P<I;P++){if(M){N.children.splice(J++,0,K[P])}else{N.children.push(K[P])}}if(M){c(N,J-K.length)}}else{N.children=[K];K.index=0}return N}}function s(J,I){I=I.getElementsByTagName("a");for(var K=I.length;K--;){J.treeIndex[I[K].getAttribute(J.options.dataID)].htmlNode=I[K]}}function g(J,I){while(J!==I){if(J.getAttribute&&w.treeIndex[J.getAttribute(w.options.dataID)]){return J}else{J=J.parentNode}}}function c(K,J){for(var L=J?+J:0,I=K.children.length;L<I;L++){K.children[L].index=L}}function k(K,J){var I=J?A:u;I(K.nodes.tree,K.options.click,function(M){var L=g(M.target,this);if(L){j(M,L,K);return false}});I(K.nodes.tree,K.options.mouseover,function(M){var L=g(M.target,this);if(L){e(M,L,K)}});I(K.nodes.tree,K.options.mousedown,function(M){var L=g(M.target,this);if(L){a(M,L,K);M.returnValue=false;M.preventDefault();return false}})}function j(P,Q,K){var R=P.target===K.nodes.jumper,L=Q.parentNode.parentNode===K.nodes.tree,N=Q.parentNode.getElementsByTagName("ul")[0],I=N&&P.target===K.nodes.toggle,O=Q.parentNode.querySelector("."+K.options.selectedClassName),M=R?"detail":P.target===Q?"select":I?(Q.parentNode.className.match(K.options.collapsedClassName)?"open":"close"):"icon",J;if(K.callbacks.clickCallback&&K.callbacks.clickCallback(P,Q,K.treeIndex[Q.getAttribute(K.options.dataID)],M,K)){return false}if(I){J=i(Q,K,f,f,N.childNodes.length);if(J&&O&&O!==Q){F(Q,K)}}else{if(K.nodes.active!==Q&&!L){F(Q,K)}}}function e(J,L,K){var I=L.parentNode.parentNode===K.nodes.tree;if(!I&&K.nodes.current!==L){E(L,K);K.nodes.current=L}}function i(Q,L,S,J,P){var T=Q.parentNode,I=T.getElementsByTagName("ul")[0],N=I.style,M=I.offsetHeight,U=0,R=L.options.openedClassName,O=L.options.collapsedClassName,K=T.className.match(O);if(L.callbacks.toggleCallback&&L.callbacks.toggleCallback(Q,J,L)||(K&&J===false||!K&&J===true)){return false}if(P!==f&&!P){if(L.callbacks.loadTreeItemsCallback&&L.callbacks.loadTreeItemsCallback(Q,L,S,J)){return false}n(T,L.options.loadingClassName);return false}if(!M){N.height="";U=I.offsetHeight;N.height=M+"px"}r(I,M?{type:"height",unit:"px",start:M,end:0}:{type:"height",unit:"px",start:0,end:U-M},S?L.options.toggleTime:r.timer(true),L.options.toggleTime,L.options.easing,function(){I.style.height=I.offsetHeight?"":"0px";if(L.callbacks.toggleEndCallback){L.callbacks.toggleEndCallback(Q,L)}});z(T,O);z(T,R);return true}function r(O,I,K,J,N,M){var L=N(K/J);if(K<J){O.style[I.type]=(I.start+L*(I.end-I.start))+I.unit;h.setTimeout(function(){r(O,I,r.timer(),J,N,M)},1000/60)}else{O.style[I.type]=I.end+I.unit;M()}}r.timer=function(I){if(!I){return new Date().getTime()-r.timer.sT||0}else{r.timer.sT=new Date().getTime();return 0}};function F(J,I){if(I.callbacks.highlightCallback&&I.callbacks.highlightCallback(J,I)){return false}n(J,I.options.selectedClassName);p(I.nodes.active,I.options.selectedClassName);I.nodes.active=J}function E(K,J){var I=K.parentNode.getElementsByTagName("ul").length;if(J.callbacks.appendCallback&&J.callbacks.appendCallback(K,J.nodes.jumper,J)){return false}K.appendChild(J.nodes.jumper);if(I){K.appendChild(J.nodes.toggle)}}function a(I,K,J){w=J;C={delayState:0,element:K,elemetOrigin:G(K),node:J.treeIndex[K.getAttribute(J.options.dataID)],x:I.pageX,y:I.pageY};u(document.body,J.options.mousemove,d);u(document.body,J.options.mouseup,y)}function d(J){var I=C;if(I.delayState||(Math.abs(J.pageX-I.x)>=w.options.dragOffset||Math.abs(J.pageY-I.y)>=w.options.dragOffset)){if(I.delayState===0){I.delayState=1;if(w.callbacks.dragStartCallback){w.callbacks.dragStartCallback(J,I.element,I.node,{x:J.pageX-I.x,y:J.pageY-I.y},I.elemetOrigin,w)}}if(w.callbacks.dragCallback){w.callbacks.dragCallback(J,I.element,I.node,w)}else{y(J)}}}function y(I){A(document.body,w.options.mousemove,d);A(document.body,w.options.mouseup,y);if(w.callbacks.dropCallback&&w.callbacks.dragCallback){w.callbacks.dropCallback(I,C.element,dragDrop.node,dragDrop.elemetOrigin,w)}}function u(K,I,J){if(!J.name){u.get=u.get||function(N,L,M){for(var O=u.cache[L].length;O--;){if(N===u.cache[L][O].obj&&""+M===""+u.cache[L][O].func){return O}}};if(!u.cache){u.cache={}}if(!u.cache[I]){u.cache[I]=[]}if(u.get(K,I,J)!==f){return}u.cache[I].push({func:J,obj:K})}if(K.addEventListener){K.addEventListener(I,J,false)}else{K.attachEvent("on"+I,J)}}function A(L,J,K){var M=-1,I=u.cache?u.cache[J]:f;if(!K.name&&I){M=u.get(L,J,K);K=M!==f?I[M].func:K}if(L.removeEventListener){L.removeEventListener(J,K,false)}else{L.detachEvent("on"+J,K)}if(M>=0){I[M].obj=null;I[M].func=null;I.splice(M,1)}}function n(K,J){var I=K.className;if(K&&!b(K,J)){K.className=I+(I?" ":"")+J}}function p(J,I){if(!J){return}J.className=J.className.replace(new RegExp("(\\b|\\s+)"+I+"(\\s+|$)","g"),function(K,L){return !K||!L?"":" "})}function b(J,I){return !J?false:new RegExp(I).test(" "+J.className+" ")}function z(K,I,J){if(!K){return}if(J||!b(K,I)){n(K,I)}else{p(K,I)}}function G(P){var K=(P.getBoundingClientRect)?P.getBoundingClientRect():{top:0,left:0},M=P&&P.ownerDocument,J=M.body,L=M.defaultView||M.parentWindow||h,I=M.documentElement||J.parentNode,O=I.clientTop||J.clientTop||0,N=I.clientLeft||J.clientLeft||0;return{left:K.left+(L.pageXOffset||I.scrollLeft)-N,top:K.top+(L.pageYOffset||I.scrollTop)-O}}})(window,window.bc&&window.bc.component?window.bc.component:window);(function(f,e,g,h,c){var a="bc-progress",j=0,l=Array.prototype.slice,d={max:100,segments:[{name:"done",value:0}],onReady:function(){},onComplete:function(){},onProgress:function(){}},b={init:function(){this.segments=this.options.segments;this._create()},increment:function(p,o){o=o||"done";if(p!==c){var m=k(this.segments,"name",o);var n=m.value;this.setValue(parseInt(p,10)+parseInt(n,10),o)}},setValue:function(n,m){var o=this;m=m||"done";if(m==="all"){e.map(this.segments,function(p){p.value=o._constrained(parseInt(n,10),parseInt(p.value,10))})}else{e.map(this.segments,function(p){if(p.name===m){p.value=o._constrained(parseInt(n,10),parseInt(p.value,10))}})}this._render()},reset:function(){this.setValue(0,"all")},_render:function(){var m=this;this.totalvalue=0;this.segments.map(function(n){m.totalvalue+=parseInt(n.value,10)});e.map(m.$segments,function(p,o){var n=parseInt(m.segments[o].value,10);p.width(m._percentage(true,n)+"%")});this.$el.attr({"aria-valuenow":this.totalvalue});this.percentage=this._percentage(false,this.totalvalue);this._trigger("progress");if(this.totalvalue===parseInt(this.options.max)){this._trigger("complete")}},_create:function(){var m=this;this.$segments=[];e.map(this.options.segments,function(n){m.$segments.push(e("<div/>",{"class":"bc-progress-bar "+n.name}))});this.$el.addClass(a).attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max}).append(this.$segments);this._trigger("ready");this._render()},_destroy:function(){this.$segments.remove();this.$el.removeClass(a).removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow")},_percentage:function(o,m){var n=100*(parseInt(m,10)-this.min)/(parseInt(this.options.max,10)-this.min);return !!o?n:n.toFixed(0)+"%"},_constrained:function(o,n){var m=this.options.max-this.totalvalue+n;return(o>m)?m:o},_trigger:function(n){var o="on"+n.charAt(0).toUpperCase()+n.slice(1);var m=l.call(arguments,1);if(typeof this.options[o]==="function"){m.push(this);this.options[o].apply(this,m);this.$el.trigger(a+":"+n,m)}}};function k(q,m,p){for(var o=0,n=q.length;o<n;o++){if(q[o][m]===p){return q[o]}}}function i(n,m){this.$el=e(n);this.options=e.extend({},d,m);this.min=0;this.init()}i.prototype=b;e.fn[a]=function(){var p,o,n;var m=arguments;o=m[0]&&e(m[0]);if(o.length>0){n=l.call(m,1)[0]||{};if(n===c||typeof n==="object"){return o.each(function(){e.data(this,"api")||e.data(this,"api",new i(this,n))})}}};f.component.progress=e.fn[a]})(bc,jQuery,window,document);(function(q){function h(F,E,G){if(G){G.trigger("blur")}F.isAutoSuggestionCancel=true;F.$template.trigger(f.ON_CANCEL)}var r=q.jQuery,l=q.bd||{},i=q.be||{},m=q.bc||{},t=q.b$||{},v=l.contextRoot!==undefined?l.contextRoot:t.portal&&t.portal.config.serverRoot!==undefined?t.portal.config.serverRoot:"",f={ON_SEARCH:"onSearch.searchTokenInput",ON_RESULT:"onResult.searchTokenInput",ON_CANCEL:"onCancel.searchTokenInput"},g=null,x,z=[{cmd:"ref",text:"References",getQuery:function(E){return E.uuid?"refuuid:"+E.uuid:this.cmd+":"+a(E)},getTooltip:function(E){return C(a(E))}},{cmd:"uses",text:"Uses content",enableAutoSuggestion:true,getQuery:function(E){return E.uuid?"usesuuid:"+E.uuid:this.cmd+":"+a(E)},getTooltip:function(E){return C(E.query)}},{cmd:"pub",text:"Publishing states"},{cmd:"@",text:"Last edited by",getTooltip:function(E){return this.text+": "+C(E.query)}}],n=function(E){var H={getLabel:function(I){return this.cmd+":"+a(I)},getQuery:function(I){return this.cmd+":"+I.uuid},getTooltip:function(I){return a(I)},enableAutoSuggestion:true},F=function(J){var N=[],L,I,P,K,M,O;for(K=0,M=J.length;K<M;K++){O=J[K];for(L=0,I=z.length;L<I;L++){P=z[L];if(O===P.cmd){N.push(r.extend({},H,P))}}}return N},G=F(E||[]);return{get:function(M,L){if(M===undefined||!(typeof(M)=="string"||M instanceof String)){return G}else{var I=r.trim(M.toLowerCase()),K=function(O){var N=O.cmd.toLowerCase()+":";return I.indexOf(N)===0},J=I.length?r.grep(G,K):[];return J.length?(L?J:J[0]):null}}}},j=function(){var E=r.Deferred();if(g!==null){if(g===true){E.resolve()}else{if(g===false){E.reject()}}}else{g="checking";i.utils.serverStatus.solr.checkStatus().then(function(){g=true;E.resolve()},function(){g=false;E.reject()})}return E.promise()},p=function(E){if(E.target){r(E.target).find(".bc-search-container").removeClass("bc-search-container-hide")}},A=function(E){if(E.target){r(E.target).find(".bc-search-container").remove()}},y=function(H){var G=(v||"")+"/static/backbase.com.2012.components/html/",F=i.utils.processHTMLTemplateByUrl(G+"modal/search.html",H);x=g===null?j():x;var E={$template:r(F),$tokenizedInput:null,isAutoSuggestionCancel:false,SearchCmd:new n(H.cmd),flg:false,changeToken:function(J,I){this.$template.find(".bc-search-input").tokenInput("clear");if(I){this.$tokenizedInput.focus()}if(r.type(J)==="string"){this.$tokenizedInput.val(J)}}};w.call(E,H);B.call(E,H);b.call(E,H);if(H.target){r(H.target).append(E.$template)}setTimeout(function(){r(document).bind("DOMNodeRemoved.search",function(I){if(I.target===E.$template[0]||r(I.target).find(".bc-search-container").length){E=null;r(document).unbind("DOMNodeRemoved.search")}})},0);if(g===true){p(H)}else{if(g===false){A(H)}else{if(g==="checking"){r.when(x).then(function(){p(H)},function(){A(H)})}}}return{cmd:E.SearchCmd.get(),$template:E.$template}},w=function(L){var G=this,E=G.SearchCmd,I=G.$template,K=L.tokenInputParams.ps?L.tokenInputParams.ps:10,J=v+"/portals/"+l.selectedPortalName+"/pagemanagement/search/suggestions",F=function(){var M=J,O=G.$tokenizedInput.val(),N=E.get(O);M+="?ps="+K+"&";if((N&&N.enableAutoSuggestion===false)||!O){M=""}if(L.tokenInputParams.urlFn&&typeof L.tokenInputParams.urlFn==="function"){M=L.tokenInputParams.urlFn(M,O,N)}return M},H={url:F,queryParam:"query",animateDropdown:false,hintText:"",searchingText:"",noResultsText:"",deleteText:"",tokenLimit:1,selectSuggestion:false,enableComma:false,clearOnBlur:false,cache:false,propertyToSearch:"query",preventDuplicates:true,contentType:"xml",resultsFormatter:function(N){var M=G.$tokenizedInput.val(),S=a(N),O=E.get(S),R=O?O.getTooltip(N):N.query,Q=O?C(M):M,P=O?C(S):S;var T=new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\-]","g");Q=Q.replace(T,"\\$&");P=P.replace(new RegExp("("+Q+")","i"),"<strong>$1</strong>");return'<li title="'+R+'"><span>'+P+"</span></li>"},tokenFormatter:function(N){var P=a(N),O=E.get(P),M="";if(O){M='<li class="bc-tokenized bc-searchToken" title="'+O.getTooltip(N)+'"><div class="bc-searchToken-cmd"><div class="bc-searchToken-text">'+u(P)+'</div></div><div class="bc-searchToken-value"><div class="bc-searchToken-text">'+C(P)+"</div></div></li>"}return M},tokenValue:function(M){return M.query},onAdd:function(M){c(M,G)},onDelete:function(){G.$tokenizedInput.focus()},onResult:function(O){var X=G.$tokenizedInput.val(),W=E.get(X),P=[];if(!G.isAutoSuggestionCancel){var V=L.tokenInputParams,R=[],Q,N,S,T,M,U={};if(V.resultData&&typeof V.resultData==="function"){R=V.resultData(O,X,W);if(R instanceof Array===false){R=e(O)}}else{R=e(O)}for(Q=0,N=R.length;Q<N;Q++){S=R[Q];T=S.title;M=S.uuid;if(W){U={query:W.getQuery({uuid:M,label:T}),label:W.getLabel({uuid:M,label:T}),uuid:M,isCmdQuery:true}}else{U={query:T,label:T,uuid:M,isCmdQuery:false}}P.push(U)}}return P}};H=r.extend({},H,L.tokenInputParams);I.find(".bc-search-input").tokenInput({},H).data("tokenLimit",H.tokenLimit);G.$tokenizedInput=I.find(".token-input-input-token").find("input").addClass("bc-tokenInput-input");s.call(G,L)},s=function(){var E=this,F=E.$template;F.on("click.searchTokenInput",".bc-searchToken",function(){F.find(".bc-search-hiddenInput").focus()}).on("dblclick.searchTokenInput",".bc-searchToken",function(){var I=F.find(".bc-search-input").tokenInput("get");if(!I.length){return}var G=I[0];var H=G.label?G.label:G.query;E.changeToken(H,true)});F.find(".bc-search-hiddenInput").on("keydown.searchTokenInput",function(G){if(G.which===8){E.changeToken("",true)}else{if(G.which===27||G.which===9){E.changeToken("",true);return false}}}).on("focus.searchTokenInput blur.searchTokenInput",function(){this.value=""});E.$tokenizedInput.on("keydown.searchTokenInput",function(G){if(G.keyCode===27||G.keyCode===9){l.observer.notifyObserver(l.pm.observer.cancelSearch);l.observer.notifyObserver("reset-search");return false}else{if(G.keyCode===13){G.stopPropagation();E.isAutoSuggestionCancel=true;c(G,E);return false}else{E.isAutoSuggestionCancel=false}}})},B=function(H){var M=this;if(!H.isBootStrap){var F=M.SearchCmd.get(),I,G,L,E=[],K,J=r(".bc-search-button",M.$template);for(I=0,G=F.length;I<G;I++){L=F[I];if(L.enableAutoSuggestion){E.push({name:L.text,value:L.cmd})}}if(!F.length){m.component.button({target:J,uid:"56562123123",searchButton:true})}else{K={target:J,type:"action-icon-div",uid:"56562123123",staticLabel:true,options:E,wrapped:true,minWidth:110,maxHeight:260,addTitle:true,iconOnly:true};m.component.dropdown(r.extend({},K,H.dropdownParams))}if(!H.isBootStrap){J.find("li.bc-icn").removeClass("bc-action").addClass("bc-search-black")}}d.call(M,H)},d=function(F){var M=this,I=r(".bc-search-button",M.$template),G=M.$template.find(".bc-search-cancel-button"),J=I.find(".bc-selectbox"),L=!!J.length,H;function K(){h(M,G,M.$tokenizedInput);G.off("click",K);return false}function E(P){var N=r(".bd-pageContainer",P.body);N.addClass("bd-search-active");P.$tokenizedInput.trigger("focus");$(document).on("keydown",function O(Q){if(Q.which===27){K()}$(document).off("keydown",O)})}l.observer.addObserver("reset-search",K);l.observer.addObserver("show-search",E);I.on("click.searchTokenInput",function(N){N.preventDefault();G.on("click",function(){l.observer.notifyObserver(l.pm.observer.cancelSearch);l.observer.notifyObserver("reset-search")});return false});if(!F.isBootStrap&&L){H=J[0].dropdownOptions;r(H).on("click.searchTokenInput",function(N){var O=r(N.target).closest("a[data-value]").attr("data-value");if(O){O=O+":";M.changeToken(O,true)}return false})}},b=function(G){var E=this,F=E.$template;F.on(f.ON_SEARCH,function(H,L,I){if(!L||!L.query){return}I=I||{};var J=r.extend({},L),K="",M=F.find(".bc-search-input");K=a(J);if(!I.isAdded){if(J.isCmdQuery===undefined){J.isCmdQuery=E.SearchCmd.get(K)?true:false}if(I.clearInput){M.tokenInput("clear")}if(J.isCmdQuery){J.isAdded=true;M.tokenInput("add",J)}else{E.$tokenizedInput.val(J.query)}}if(K.length){o(F,false,G.isBootStrap)}if(k(F)){F.find(".bc-search-hiddenInput").focus()}if(G.onSearch){G.onSearch(J.isCmdQuery?M.tokenInput("get"):(M.tokenInput("get")).concat(J))}});E.$template.on("click",".bc-search-icon.bi-pm-x",function(){E.$template.trigger(f.ON_CANCEL)});E.$template.on("click",".bc-search-icon.bi-pm-magnifier",function(H){H.target=E.$template.find(".bc-tokenInput-input");c(H,E)});E.$template.on(f.ON_RESULT,function(H,I){o(E.$template,false,G.isBootStrap);if(G.onResult){G.onResult(I)}D(E.$template,true)});E.$template.on(f.ON_CANCEL,function(H,I){E.changeToken("");o(E.$template,false,G.isBootStrap);if(G.onCancel){G.onCancel(I)}D(E.$template,false)})},u=function(F){var E=F.split(":");return E.length>1?E[0].toLowerCase():""},C=function(F){var E=F.split(":");if(E.length>1){E.shift()}return E.join(":")},k=function(E){var H=E.find(".bc-search-input"),F=H.tokenInput("get").length,G=H.data("tokenLimit");return F>=G},a=function(E){return E.label?E.label:E.query},o=function(F,H,E){if(E){return}var G=r(".bc-search-input-container",F).find(".bc-search-icon");if(H===true){G.removeClass("bi-pm-magnifier").addClass("bi-spinner")}else{G.removeClass("bi-spinner").addClass("bi-pm-magnifier")}},D=function(E,G){var F=r(".bc-search-input-container",E).find(".bc-search-icon");if(G===true){F.removeClass("bi-pm-magnifier").addClass("bi-pm-x")}else{F.removeClass("bi-pm-x").addClass("bi-pm-magnifier")}},c=function(H,F){if(!H){return}var I,G={},E={};if(H.target){I=r(H.target).val();if(I){if(F.flg){F.flg=false}else{G={query:I}}}}else{if(H.isAdded){delete H.isAdded;return}else{if(H.query){G=H;I=H.label?H.label:H.query;if(F.SearchCmd.get(I)){E.isAdded=true}else{F.$tokenizedInput.val(I);F.flg=true;q.setTimeout(function(){F.flg=false},300)}}}}F.$template.trigger(f.ON_SEARCH,[G,E])},e=function(G){var E=r(G).find("suggestion"),I,F,L,K,J,H=[];for(I=0,F=E.length;I<F;I++){L=r(E[I]);K=L.find("title").text();J=L.find("uuid").text();H.push({title:K,uuid:J})}return H};m.component.searchTokenInput=y})(window);