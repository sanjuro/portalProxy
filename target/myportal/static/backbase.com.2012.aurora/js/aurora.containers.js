(function(){var e=b$.bdom.getNamespace("http://backbase.com/2012/portalView");var g=b$.view.bdom.layout;var d=g.Layout;var f=function(h){var j=h.firstChild;while(j){if(j.nodeType==1&&j.nodeName.toLowerCase()==="table"){return j}j=j.nextSibling}};var c=e.registerElement("BoxColumnLayout",d.extend(function(h){d.call(this,h);this.myBoxLayout=new BoxLayout()},{doLayout2:function(l,h){this.component.setHTMLWidthHeight(l,h);var m=this.component.htmlAreas;var j=this.component.getAreaOrderedChildren();this.myBoxLayout.component=this.component;this.myBoxLayout.setDirection(false);var k=this.myBoxLayout.computeChildCoords(m,{width:l,height:h});this.myBoxLayout.updateChildBoxes(k.boxes);this.component.htmlNode;this.component.htmlAreas;this.component.htmlPanels},doLayout:function(l,y){this.component.setHTMLWidthHeight(l,y);var h=this.component.getAreaOrderedChildren();this.myBoxLayout.component={};this.myBoxLayout.component.htmlAreas=[];this.myBoxLayout.component.htmlAreas[0]=this.component.htmlNode;this.myBoxLayout.setDirection(false);l=parseInt(this.component.htmlAreas[0].style.width,10);y=parseInt(this.component.htmlAreas[0].style.height,10);var u=this.component.aCoords;if(!u){u=[100]}var n=0;var o=30;this.component.htmlResizerGrips[0].style.width="";this.component.htmlResizerGrips[0].style.minHeight="20px";var o=htmlAPI.getWidth(this.component.htmlResizerGrips[0]);var s=parseInt(htmlAPI.getStyle(this.component.htmlResizerGrips[0],"padding-left"),10);s+=parseInt(htmlAPI.getStyle(this.component.htmlResizerGrips[0],"border-left-width"),10);var m=parseInt(htmlAPI.getStyle(this.component.htmlNode,"padding-left"),10);m+=parseInt(htmlAPI.getStyle(this.component.htmlAreas[0],"border-left-width"),10);l=l-(o*(h.length-1));for(var r=0;r<h.length;r++){if(h[r]){var x=u[r];if(x){x=(l/100)*x}else{x=100}var t=this.myBoxLayout.computeChildCoords(h[r],{width:x,height:y});for(var q=0;q<t.boxes.length;q++){t.boxes[q].left=n}n+=x;if(this.component.htmlResizerGrips[r]){this.component.htmlResizerGrips[r].style.left=(n+m-s)+"px";n+=o}this.myBoxLayout.updateChildBoxes(t.boxes);for(var v=0,p=h[r].length;v<p;v++){h[r][v].reflow()}}else{if(this.component.htmlResizerGrips[r]){var x=u[r];if(x){x=(l/100)*x}else{x=100}n+=x;this.component.htmlResizerGrips[r].style.left=(n+m-s)+"px";n+=o}}}if(h.length<u.length){for(r=0;r<u.length-1;r++){if(!h[r]){var x=u[r];if(x){x=(l/100)*x;n+=x}if(this.component.htmlResizerGrips[r]){this.component.htmlResizerGrips[r].style.left=(n+m-s)+"px";n+=o}}}}}}));var a=e.registerElement("ResizableColumnLayout",d.extend(null,{doLayout:function(k,h){var j=this.component.aCoords;if(!j){j=[100]}var l=jQuery(this.component.htmlResizerGrips[0]).width();for(i=0;i<j.length;i++){this.component.htmlAreas[i].style.width=j[i]+"%"}for(i=0;i<j.length-1;i++){var m=this.component.htmlAreas[i].offsetLeft+this.component.htmlAreas[i].offsetWidth;this.component.htmlResizerGrips[i].style.left=m+"px"}}}));var b=e.registerElement("ResizableBorderLayout",d.extend(null,{doLayout:function(j,w){var r,m=this.component.htmlNode.offsetLeft,u=this.component.htmlNode.offsetTop,t=this.component.aCoords,o=this.component.htmlAreas,v=this.component.htmlNode;var l=jQuery(this.component.htmlResizerGrips.h[0]).width();var k=parseInt(jQuery(this.component.htmlAreas[0]).css("min-height"),10);if(isNaN(k)){k=20}this.component.minRowHeight=k/(this.component.aCoords.fixedHeight||parseInt(jQuery(this.component.htmlNode).outerHeight()))*100;var p=k*3+l*4;var s=null;if(t.fixedHeight){t.fixedHeight=Math.max(t.fixedHeight,p)}if(t.h.length&&t.fixedHeight){v.style.height=t.fixedHeight+"px";f(v).style.height=t.fixedHeight+"px";if(jQuery("html",document).hasClass("ie9minus")){var q=parseInt(jQuery("table",this.component.htmlNode).css("border-spacing"));jQuery("> table",this.component.htmlNode).css("height",(t.fixedHeight-q*4)+"px")}jQuery(this.component.htmlNode).addClass("bp-fixedHeight");for(r=0;r<3;r++){if(jQuery.browser.mozilla||jQuery.browser.msie&&jQuery.browser.version<=8){var n=(t.fixedHeight-l*4)/100*t.h[r];if(r===0){o[0].style.height=n+"px"}else{if(r===1){o[1].style.height=o[2].style.height=o[3].style.height=n+"px"}else{if(r===2){o[4].style.height=n+"px"}}}}else{this.component.htmlRows[r].style.height=t.h[r]+"%"}}}else{jQuery(this.component.htmlNode).removeClass("bp-fixedHeight");this.component.htmlNode.style.height=""}if(t.w.length){for(r=1;r<4;r++){this.component.htmlAreas[r].parentNode.style.width=t.w[r-1]+"%";this.component.htmlCols[r-1].style.width=t.w[r-1]+"%";s=Math.max(o[1].offsetHeight,o[2].offsetHeight,o[3].offsetHeight)}for(r=1;r<3;r++){var m=this.component.htmlAreas[r].offsetLeft+this.component.htmlAreas[r].offsetWidth;this.component.htmlResizerGrips.h[r-1].style.left=m+"px";this.component.htmlResizerGrips.h[r-1].style.top=(o[0].offsetTop+o[0].offsetHeight+l)+"px";this.component.htmlResizerGrips.h[r-1].style.height=s+"px"}}this.component.htmlResizerGrips.v[0].style.top=(o[0].offsetTop+o[0].offsetHeight)+"px";this.component.htmlResizerGrips.v[1].style.top=(o[4].offsetTop-l)+"px";this.component.htmlResizerGrips.v[2].style.top=(v.clientHeight-l)+"px"}}))})();/*!
 *	----------------------------------------------------------------
 *	Copyright Backbase b.v. 2003/2012
 *	All rights reserved.
 *	----------------------------------------------------------------
 *	Version 5.5
 *	Author : Backbase R&D - Amsterdam - New York
 *	----------------------------------------------------------------
 */
(function(h){var c=b$.Class;var d=b$.bdom.getNamespace("http://backbase.com/2012/portalView");var e=d.getClass("container");var j=b$.view.bdom.layout;var a=d.getClass("ResizableColumnLayout");var k=function(n){var l=h(n).offset();var m={x:l.left,y:l.top,left:l.left,top:l.top,w:n.offsetWidth,h:n.offsetHeight};return m};var i=function(m,l){while(m){if(h(m).hasClass(l)){return m}m=m.parentNode}};function b(n,m){var o=false,l=m&&m.length?m:["padding","numberOfColumns","columnWidths","rowHeights","fixedHeight"];n.addEventListener("preferencesSaved",function(p){if(o){n.refreshHTML(function(){o=false})}},false,n);n.model.addEventListener("PrefModified",function(p){if(!o&&n.model.name===p.target.name){if(h.inArray(p.attrName,l)!==-1){o=true}}},false,n)}var f=d.registerElement("Column_table",e.extend(function(n,m,l,o){e.call(this,n,m,l,o);this.isPossibleDragTarget=true},{buildHTML:function(m){var l=document;m=e.prototype.buildHTML.call(this,m);this.htmlAreas=h("> table > tbody > tr > td",m);if(this.getPreference("isManageableArea")==true){this.addEventListenerManageableArea()}return m},readyHTML:function(){b(this);if(this.getPreference("isManageableArea")==true){this.initManageableArea()}},getContainerTemplate:function(){var q=this.model.getJSON(),p=q.preferences,l=1,n,m,o;for(m=0;m<p.length;m++){o=p[m];if(o.name=="numberOfColumns"){l=o.value||1;break}}n='<div class="bp-container bp-ColumnLayout bp-ui-dragRoot"><table cellspacing="0" class="bp-ColumnLayout-table"><tbody><tr class="bp-ColumnLayout-tr">';for(m=0;m<l;m++){n+='<td class="bp-area bp-align-top bp-ColumnLayout-td bp-ColumnLayout-column-'+m+'"></td>'}n+="</tr></tbody></table></div>";return n},initManageableArea:function(){var s=this;while(s.model.tag.toLowerCase()!=="page"&&s.model.tag.toLowerCase()!=="portal"&&s.model.tag.toLowerCase()!=="application"){s=s.parentNode}if(s.pageType=="master"){if(!b$._private.htmlAPI.hasClass(this.htmlNode,"bp-manageableArea-masterpage")){b$._private.htmlAPI.addClass(this.htmlNode,"bp-manageableArea-masterpage")}var l=h(".bp-manageableArea--message",this.htmlNode);if(l.length==0){l=document.createElement("div");l.setAttribute("class","bp-manageableArea--message");var q=document.createElement("div");var r=document.createTextNode("Manageable area");var o=document.createElement("div");var p=document.createTextNode("Reordering, deleting and adding items");var m=document.createElement("div");var n=document.createTextNode("is allowed on regular pages");q.appendChild(r);o.appendChild(p);m.appendChild(n);l.appendChild(q);l.appendChild(o);l.appendChild(m);this.htmlNode.appendChild(l)}}else{s.isPossibleDragTarget=false}},addEventListenerManageableArea:function(){this.addEventListener("DOMNodeInserted",function(l){if(l.target.parentNode==this){if(this.childNodes.length!==0){b$._private.htmlAPI.removeClass(this.htmlNode,"bp-manageableArea-empty")}}},false);this.addEventListener("DOMNodeInsertedIntoDocument",function(l){if(l.target==this){if(this.childNodes&&this.childNodes.length==0){b$._private.htmlAPI.addClass(this.htmlNode,"bp-manageableArea-empty")}}},false);this.addEventListener("DOMNodeRemoved",function(l){if(l.target.parentNode==this){if(this.childNodes&&this.childNodes.length==0){b$._private.htmlAPI.addClass(this.htmlNode,"bp-manageableArea-empty")}else{if(this.childNodes&&this.childNodes.length==1&&l.target==this.childNodes[0]){b$._private.htmlAPI.addClass(this.htmlNode,"bp-manageableArea-empty")}}}},false);this.addEventListener("dragEnter",function(l){if(l.target==this&&this.ownerDocument.dragManager.dragOptions.htmlNode.catalogItemJson){var m=this.ownerDocument.dragManager.dragOptions.htmlNode.catalogItemJson.preferences.isManageableArea;if(m&&m.value=="true"){b$._private.htmlAPI.addClass(this.htmlNode,"bp-manageableArea-noDropZone")}}},false);this.addEventListener("dragLeave",function(l){if(l.target==this){b$._private.htmlAPI.removeClass(this.htmlNode,"bp-manageableArea-noDropZone")}},false)}}));var g=d.registerElement("Column_table_resizable",f.extend(function(n,m,l,o){f.call(this,n,m,l,o);this.isPossibleDragTarget=true;this.layout=new a(this)},{buildHTML:function(t){var q=document,r,n;t=e.prototype.buildHTML.call(this,t);var p={ADMIN:0,CREATOR:-1,COLLABORATOR:-2,CONTRIBUTOR:-3,CONSUMER:-4};var o=p[this.model.securityProfile];if(o>=p.CREATOR){h(t).addClass("bp-can-resize")}this.htmlAreas=h("> table > tbody > tr > td",t);this.aCoords=[];this.numberOfColumns=Math.abs(parseInt(this.getPreference("numberOfColumns")))||1;var s=this.getPreference("columnWidths").split(",").map(function(l){return parseFloat(l)});var m=this.constrainProportions(s,this.numberOfColumns);if(m.toString()!==s.toString()){s=m;this.setPreference("columnWidths",s.map(function(l){return l+"%"}).join(","));this.model.save()}for(r=0,n=s.length;r<n;r++){this.aCoords.push(s[r])}this.htmlResizerGrips=[];for(r=0;r<t.childNodes.length;r++){if(h(t.childNodes[r]).hasClass("bp-ui-resizeGrip")){this.htmlResizerGrips.push(t.childNodes[r])}}this.resizeIndicators=[];for(r=0;r<t.childNodes.length;r++){if(h(t.childNodes[r]).hasClass("bp-ui-resizeIndicator")){this.resizeIndicators.push(t.childNodes[r])}}return t},getContainerTemplate:function(){var r=this.model.getJSON(),q=r.preferences,m=1,l=5,o,n,p;for(n=0;n<q.length;n++){p=q[n];if(p.name=="numberOfColumns"){m=p.value||1;break}if(p.name==="padding"){l=parseInt(p.value)}}o='<div class="bp-container bp-ColumnLayout bp-ui-dragRoot"><table cellspacing="0" class="bp-ColumnLayout-table" style="border-spacing:'+l+'px; border-collapse: separate;"><tbody><tr class="bp-ColumnLayout-tr">';for(n=0;n<m;n++){o+='<td class="bp-area bp-align-top bp-ColumnLayout-td bp-ColumnLayout-column-'+n+'"></td>'}o+="</tr></tbody></table>";for(n=0;n<m-1;n++){o+='<div class="aa-resizebar bp-ui-resizeGrip"><div class="aa-resizebar-inner"></div></div>'}o+='<div class="bp-ui-resizeIndicator"></div>';o+='<div class="bp-ui-resizeIndicator"></div>';o+="</div>";return o},readyHTML:function(){var l=this;this.addEventListener("dragDrop",function(o){var m=this.ownerDocument.dragManager;if(i(m.dragOptions.target,m.cqs_resizeGrip)){var n=this.constrainProportions(this.aCoords,this.numberOfColumns);n=n.map(function(p){return p+"%"}).join(",");this.setPreference("columnWidths",n);this.model.save()}});this.addEventListener("dragEnter",function(n){var m=this.ownerDocument.dragManager;if(this.htmlResizerGrips.indexOf(m.dragOptions.target)!==-1){}});l.model.addEventListener("PrefModified",function(p){l.aCoords=[];l.numberOfColumns=Math.abs(parseInt(l.getPreference("numberOfColumns")))||1;var o=l.getPreference("columnWidths").split(",").map(function(q){return parseFloat(q)});for(var n=0,m=o.length;n<m;n++){l.aCoords.push(o[n])}l.reflow()},false,l);b(this,["padding","numberOfColumns"]);this.reflow()},_containerReflow:function(){this.reflow()},m_resize:function(z,v){var r=z.clientX,q=z.clientY,D,w;var t=r;var n=this.htmlResizerGrips.indexOf(v.dragOptions.target);var C=n+1;var l=Number(this.aCoords[n])+Number(this.aCoords[C]);var u=k(this.htmlNode);var A=u.left+(n>0?this.htmlAreas[n-1].offsetLeft+this.htmlAreas[n-1].offsetWidth:0);r=(r-A)/(u.w)*100;r=r<0?0:r>l?l:r;this.aCoords[n]=r;this.aCoords[C]=l-r;this.reflow();var B=h(this.htmlNode).offset().top;var p=h(this.htmlNode).offset().left;var m=this.htmlResizerGrips[n].offsetTop;var E=this.htmlResizerGrips[n].offsetTop+this.htmlResizerGrips[n].offsetHeight-this.resizeIndicators[0].offsetHeight;var s=this.htmlResizerGrips[n].offsetLeft;this.resizeIndicators[0].innerHTML=Math.round(this.aCoords[n])+"%";this.resizeIndicators[0].style.top=Math.min(Math.max((z.clientY-B-8),m),E)+"px";this.resizeIndicators[0].style.left=(s-38)+"px";this.resizeIndicators[1].innerHTML=Math.round(this.aCoords[C])+"%";this.resizeIndicators[1].style.top=Math.min(Math.max((z.clientY-B-8),m),E)+"px";this.resizeIndicators[1].style.left=(s+13)+"px";var o=this.getAreaOrderedChildren();if(o[n]){for(D=0,w=o[n].length;D<w;D++){if(o[n][D].model.tag==="container"){o[n][D].reflow()}}}if(o[C]){for(D=0,w=o[C].length;D<w;D++){if(o[C][D].model.tag==="container"){o[C][D].reflow()}}}}}))}(jQuery));